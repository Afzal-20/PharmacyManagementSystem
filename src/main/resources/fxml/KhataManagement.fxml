<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<VBox xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.my.pharmacy.controller.KhataController" style="-fx-background-color: #f4f7f6; -fx-padding: 20;" spacing="15">
    <Label text="KHATA / LEDGER MANAGEMENT" style="-fx-text-fill: #2c3e50; -fx-font-weight: bold;">
        <font><Font size="22.0"/></font>
    </Label>

    <TabPane VBox.vgrow="ALWAYS" tabClosingPolicy="UNAVAILABLE" style="-fx-background-color: white; -fx-border-color: #bdc3c7;">

        <Tab text="Customers (Receivables)">
            <BorderPane style="-fx-padding: 15;">
                <top>
                    <HBox spacing="15" alignment="CENTER_LEFT" style="-fx-padding: 0 0 15 0;">
                        <Label text="Select Customer:" style="-fx-font-weight: bold;"/>
                        <ComboBox fx:id="customerComboBox" prefWidth="300" promptText="Search Customer..."/>
                        <Button text="Load Ledger" onAction="#loadCustomerLedger" style="-fx-background-color: #3498db; -fx-text-fill: white;"/>
                    </HBox>
                </top>
                <center>
                    <TableView fx:id="customerLedgerTable">
                        <columns>
                            <TableColumn fx:id="colCustDate" text="Date" prefWidth="150"/>
                            <TableColumn fx:id="colCustDesc" text="Description" prefWidth="250"/>
                            <TableColumn fx:id="colCustDebit" text="Charged (Bill)" prefWidth="120"/>
                            <TableColumn fx:id="colCustCredit" text="Paid (Receipt)" prefWidth="120"/>
                        </columns>
                    </TableView>
                </center>
                <right>
                    <VBox spacing="15" style="-fx-padding: 0 0 0 15;" prefWidth="280">
                        <VBox style="-fx-background-color: #ecf0f1; -fx-padding: 15; -fx-border-color: #bdc3c7;">
                            <Label text="Customer Owes You:" style="-fx-font-size: 14;"/>
                            <Label fx:id="lblCustomerBalance" text="Rs. 0.00" style="-fx-font-size: 24; -fx-font-weight: bold; -fx-text-fill: #c0392b;"/>
                        </VBox>
                        <VBox spacing="10" style="-fx-background-color: #f9f9f9; -fx-padding: 15; -fx-border-color: #bdc3c7;">
                            <Label text="Record Recovery" style="-fx-font-weight: bold;"/>
                            <TextField fx:id="custPaymentAmountField" promptText="Amount Received"/>
                            <TextField fx:id="custPaymentDescField" promptText="Note (e.g. Cash)"/>
                            <Button text="Save Payment" onAction="#handleSaveCustomerPayment" maxWidth="Infinity" style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-weight: bold;"/>
                        </VBox>
                    </VBox>
                </right>
            </BorderPane>
        </Tab>

        <Tab text="Dealers (Payables)">
            <BorderPane style="-fx-padding: 15;">
                <top>
                    <HBox spacing="15" alignment="CENTER_LEFT" style="-fx-padding: 0 0 15 0;">
                        <Label text="Select Dealer:" style="-fx-font-weight: bold;"/>
                        <ComboBox fx:id="dealerComboBox" prefWidth="300" promptText="Search Dealer..."/>
                        <Button text="Load Ledger" onAction="#loadDealerLedger" style="-fx-background-color: #9b59b6; -fx-text-fill: white;"/>
                    </HBox>
                </top>
                <center>
                    <TableView fx:id="dealerLedgerTable">
                        <columns>
                            <TableColumn fx:id="colDealDate" text="Date" prefWidth="150"/>
                            <TableColumn fx:id="colDealDesc" text="Description" prefWidth="250"/>
                            <TableColumn fx:id="colDealDebit" text="Charged (Bill)" prefWidth="120"/>
                            <TableColumn fx:id="colDealCredit" text="Paid (Cash out)" prefWidth="120"/>
                        </columns>
                    </TableView>
                </center>
                <right>
                    <VBox spacing="15" style="-fx-padding: 0 0 0 15;" prefWidth="280">
                        <VBox style="-fx-background-color: #ecf0f1; -fx-padding: 15; -fx-border-color: #bdc3c7;">
                            <Label text="You Owe Dealer:" style="-fx-font-size: 14;"/>
                            <Label fx:id="lblDealerBalance" text="Rs. 0.00" style="-fx-font-size: 24; -fx-font-weight: bold; -fx-text-fill: #c0392b;"/>
                        </VBox>
                        <VBox spacing="10" style="-fx-background-color: #f9f9f9; -fx-padding: 15; -fx-border-color: #bdc3c7;">
                            <Label text="Record Payment Out" style="-fx-font-weight: bold;"/>
                            <TextField fx:id="dealPaymentAmountField" promptText="Amount Paid to Dealer"/>
                            <TextField fx:id="dealPaymentDescField" promptText="Note (e.g. Bank Transfer)"/>
                            <Button text="Save Payment" onAction="#handleSaveDealerPayment" maxWidth="Infinity" style="-fx-background-color: #2980b9; -fx-text-fill: white; -fx-font-weight: bold;"/>
                        </VBox>
                    </VBox>
                </right>
            </BorderPane>
        </Tab>

    </TabPane>
</VBox>